Amplify {
Secret
IOT_ENDPOINT_URL = aplwx973aujgp-ats.iot.eu-central-1.amazonaws.com

Env Var
ADD_DEVICE_ENDPOINT = https://fuqcg5ljae.execute-api.eu-central-1.amazonaws.com/AddDevice/amplify-d1oceu7bffyxdg-ma-createDeviceFunctionlamb-oG9vHtl2RenF
}

{
  "Origin": "https://main.d1oceu7bffyxdg.amplifyapp.com",
  "Access-Control-Request-Method": "POST",
  "Access-Control-Request-Headers": "authorization, content-type"
}


services need to start in this order:
1. auth/cognito
2. dynamoDB
3.iotCore - need arn/name from dynamoDB
4.createDevice - need arn from IotCore
5.fetchDevices - need arn/name from dynamoDB
6.apiGateway - need arn/name from createDevice, fetchDevices, and auth/cognito


AKIA47GB7VXYF46SVHDJ

9MyX8naxeRUsHnzWrsudhb7bW7HagdMBW91uL8Mp


ownerID: 550e8400-e29b-41d4-a716-446655440000


CreateDeviceLambda_To_IotCore - policy:
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "iot:CreateThing",
                "iot:AttachThingPrincipal",
                "iot:UpdateThingShadow"
            ],
            "Resource": "arn:aws:iot:eu-central-1:891612540400:thing/*"
        },
        {
            "Effect": "Allow",
            "Action": [
                "iot:AttachThingPrincipal"
            ],
            "Resource": "arn:aws:iot:eu-central-1:891612540400:cert/*"
        },
        {
            "Effect": "Allow",
            "Action": [
                "iot:DescribeEndpoint",
                "iot:CreateKeysAndCertificate"
            ],
            "Resource": "*"
        }
    ]
}


message route rules iot core:
SELECT *, clientid() AS DeviceId, timestamp() AS Timestamp FROM '+/telemetry'


secrets:
